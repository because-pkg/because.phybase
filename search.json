[{"path":"https://because-pkg.github.io/because.phybase/articles/03_phylogenetic_models.html","id":"back-to-the-rhinograds-phylogenetic-structural-equation-models-phybase-with-because","dir":"Articles","previous_headings":"","what":"Back to the Rhinograds: Phylogenetic Structural Equation Models (PhyBaSE) with because","title":"Phylogenetic Models","text":"One core features package ability fit Phylogenetic Bayesian Structural Equation models (PhyBaSE) .phybase module, allowing researchers account shared evolutionary history among species analysing causal relationships among traits. use Rhinogradentia dataset tree previously analysed Gonzalez-Voyer von Hardenberg, (2014) von Hardenberg Gonzalez-Voyer (2025). Letâ€™s start loading necessary packages data: previous implementations necessary compute variance-covariance matrix tree pass JAGS, handles internally. need provide phylogenetic tree (class phylo) via structure argument. Also, automatically matches species names data tree: need ensure species names data frame column specified species match tip labels tree provide name species column () function id_col argument. Also, need rescale total tree length 1 (needed correct estimation Pagelâ€™s lambda parameter), handle internally. , letâ€™s specify structural equations best model (sem8) fitted von Hardenberg Gonzalez-Voyer (2025):  Now can fit model () including phylogenetic tree structure argument. Also, complex model previous examples, speed model fitting run 3 chains parallel using parallel = TRUE n.cores = 3 arguments. Also request WAIC information criterion computed setting WAIC = TRUE: output shows posterior parameters consistent obtained coding model directly JAGS (von Hardenberg Gonzalez-Voyer, 2025; code available supplementary materials paper).","code":"library(because.phybase) #the main `because` package will be loaded automatically   data(rhino.dat) data(rhino.tree) sem8_eq <- list(     LS ~ BM,     NL ~ BM + RS,     DD ~ NL )  plot_dag(sem8_eq) fit_sem8 <- because(     equations = sem8_eq,     data = rhino.dat,     structure = rhino.tree,     id_col = \"SP\",     WAIC = TRUE,     parallel = TRUE,     n.cores = 3 )  summary(fit_sem8)  #                  Mean    SD Naive SE Time-series SE   2.5%    50% 97.5% # alphaDD         0.581 0.276    0.005          0.007  0.036  0.582 1.146 # alphaLS         0.344 0.416    0.008          0.016 -0.490  0.346 1.138 # alphaNL        -0.055 0.339    0.006          0.015 -0.731 -0.054 0.601 # beta_DD_NL      0.536 0.074    0.001          0.001  0.390  0.538 0.682 # beta_LS_BM      0.472 0.085    0.002          0.002  0.309  0.470 0.641 # beta_NL_BM      0.470 0.068    0.001          0.001  0.336  0.471 0.604 # beta_NL_RS      0.597 0.068    0.001          0.001  0.461  0.596 0.728 # lambdaDD        0.462 0.130    0.002          0.003  0.218  0.462 0.717 # lambdaLS        0.696 0.107    0.002          0.003  0.459  0.709 0.862 # lambdaNL        0.719 0.086    0.002          0.002  0.533  0.727 0.863 # sigma_DD_phylo  0.803 0.174    0.003          0.003  0.503  0.790 1.178 # sigma_DD_res    0.856 0.088    0.002          0.002  0.694  0.852 1.041 # sigma_LS_phylo  1.253 0.204    0.004          0.005  0.865  1.246 1.675 # sigma_LS_res    0.804 0.104    0.002          0.002  0.615  0.802 1.013 # sigma_NL_phylo  1.026 0.145    0.003          0.004  0.766  1.013 1.338 # sigma_NL_res    0.626 0.075    0.001          0.002  0.490  0.622 0.783 #                 Rhat n.eff # alphaDD        1.000  1408 # alphaLS        1.003   639 # alphaNL        1.000   553 # beta_DD_NL     1.000  3088 # beta_LS_BM     1.001  2178 # beta_NL_BM     1.000  2255 # beta_NL_RS     1.001  2801 # lambdaDD       1.002  2136 # lambdaLS       1.000  1595 # lambdaNL       1.001  1788 # sigma_DD_phylo 1.002  2741 # sigma_DD_res   1.000  2712 # sigma_LS_phylo 1.000  1612 # sigma_LS_res   1.001  2103 # sigma_NL_phylo 1.001  1600 # sigma_NL_res   1.001  2427 #  # DIC: # Mean deviance:  670  # penalty 133.7  # Penalized deviance: 803.6  #  # WAIC: # WAIC with Standard Errors # ------------------------- # N = 300 observations, 3000 MCMC samples #  #           Estimate   SE # elpd_waic   -395.1  9.9 # p_waic        93.7  5.1 # waic         790.2 19.8"},{"path":"https://because-pkg.github.io/because.phybase/articles/03_phylogenetic_models.html","id":"the-random-effects-formulation-of-because","dir":"Articles","previous_headings":"Back to the Rhinograds: Phylogenetic Structural Equation Models (PhyBaSE) with because","what":"The random effects formulation of because","title":"Phylogenetic Models","text":"familiar output obtained model, may however noticed besides Pagelâ€™s Î»\\lambda parameters response variable, () also get estimates standard deviations phylogenetic residual components (sigma_[RESP]_phylo sigma_[RESP]_res, respectively). estimated uses optimised random effect formulation improve MCMC significantly reduce runtime. standard phylogenetic models must invert covariance matrix every iteration (Î»\\lambda changes), random effect approach mathematically equivalent computationally efficent. decomposes response three additive components: yi=Î¼i+ui+Ïµiy_i = \\mu_i + u_i + \\epsilon_i : Î¼i\\mu_i fixed effect (structural equation mean) uiu_i phylogenetic random effect: ð®âˆ¼ð’©(ðŸŽ,Ïƒu2ð•)\\mathbf{u} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_u^2 \\mathbf{V}) Ïµi\\epsilon_i residual error: ð›œâˆ¼ð’©(ðŸŽ,Ïƒe2ðˆ)\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma_e^2 \\mathbf{}) allows us pre-compute inverse phylogenetic variance-covariance matrix (ð•âˆ’1\\mathbf{V}^{-1}) pass JAGS fixed data. JAGS simply scales fixed precision matrix 1/Ïƒ\\sigma, avoiding costly repeated inversions. Consequently, Î»\\lambda derived posterior variance components : Î»=Ïƒphylo2Ïƒphylo2+Ïƒres2\\lambda = \\frac{\\sigma_{phylo}^2}{\\sigma_{phylo}^2 + \\sigma_{res}^2} approach also used packages MCMCglmm (Hadfield, 2010) brms (BÃ¼rkner, 2017).","code":""},{"path":"https://because-pkg.github.io/because.phybase/articles/03_phylogenetic_models.html","id":"improved-waic-calculation","dir":"Articles","previous_headings":"Back to the Rhinograds: Phylogenetic Structural Equation Models (PhyBaSE) with because","what":"Improved WAIC calculation","title":"Phylogenetic Models","text":"improved WAIC calculation, compared calculated von Hardenberg & Gonzalez-Voyer, (2025). WAIC now computed directly pointwise log-likelihoods monitored model fitting, rather approximating deviance done previously. approach, besides providing accurate estimates WAIC deviance-based approximation provided JAGS, also allows us compute standard errors WAIC (following method suggested Vehtari et al.Â 2017) allowing reliable model comparisons.","code":""},{"path":"https://because-pkg.github.io/because.phybase/articles/03_phylogenetic_models.html","id":"testing-conditional-independencies-with-d-separation","dir":"Articles","previous_headings":"Back to the Rhinograds: Phylogenetic Structural Equation Models (PhyBaSE) with because","what":"Testing conditional independencies with d-separation","title":"Phylogenetic Models","text":"Letâ€™s now test conditional independencies implied model (set WAIC = FALSE speed computation, need compare models): expected, conditional independencies supported, indicating hypothesised causal structure consistent data.","code":"test_sem8_dsep <- because(     equations = sem8_eq,     data = rhino.dat,     structure = rhino.tree,     id_col = \"SP\",     dsep = TRUE,     WAIC = FALSE,     parallel = TRUE,     n.cores = 3 )  summary(test_sem8_dsep)  # d-separation Tests # ================== #  # Test: RS _||_ BM | {}   #   Parameter Estimate LowerCI UpperCI Indep    P  Rhat n.eff #  beta_RS_BM   -0.029  -0.238   0.177   Yes 0.78 1.002  2177 #  # Test: RS _||_ DD | {NL}  #   Parameter Estimate LowerCI UpperCI Indep     P Rhat n.eff #  beta_RS_DD   -0.117   -0.33   0.107   Yes 0.301    1  2563 #  # Test: RS _||_ LS | {BM}  #   Parameter Estimate LowerCI UpperCI Indep     P Rhat n.eff #  beta_RS_LS   -0.019  -0.248    0.22   Yes 0.873    1  2423 #  # Test: BM _||_ DD | {NL}  #   Parameter Estimate LowerCI UpperCI Indep     P Rhat n.eff #  beta_BM_DD    0.117  -0.111   0.342   Yes 0.322    1  1824 #  # Test: NL _||_ LS | {RS,BM}  #   Parameter Estimate LowerCI UpperCI Indep    P Rhat n.eff #  beta_NL_LS    0.013  -0.151   0.177   Yes 0.86    1  2134 #  # Test: DD _||_ LS | {NL,BM}  #   Parameter Estimate LowerCI UpperCI Indep     P  Rhat n.eff #  beta_DD_LS   -0.063  -0.245   0.114   Yes 0.495 1.002  2693 #  #  # Legend: #   Indep: 'Yes' = Conditionally Independent, 'No' = Dependent (based on 95% CI) #   P: Bayesian probability that the posterior distribution overlaps with zero"},{"path":"https://because-pkg.github.io/because.phybase/articles/03_phylogenetic_models.html","id":"accounting-for-measurement-error-in-traits-in-phybase-models","dir":"Articles","previous_headings":"Back to the Rhinograds: Phylogenetic Structural Equation Models (PhyBaSE) with because","what":"Accounting for measurement error in traits in PhyBaSE models","title":"Phylogenetic Models","text":"von Hardenberg Gonzalez-Voyer (2025), showed PhyBaSE models can specified account measurement error traits. models can also fitted (). case available repeated measures per species, sufficient provide data frame measurements (.e.Â multiple rows per species) specify id_col argument indicate species identifier column. () automatically format data create response matrix species rows replicates columns, padding NAs necessary. use data simulated von Hardenberg Gonzalez-Voyer (2025) example. trait transformed distribution mean equal original species trait value rhino.dat SD equal proportion (25%) among-species variance trait. 10 repeated measures sampled species. resulting data frame RhinoMulti.dat contains 1000 rows (10 replicates 100 species) 6 columns (species identifier 5 traits). Letâ€™s load data fit model accounting repeated measures: von Hardenberg Gonzalez-Voyer (2025) showed also account measurement error single observation per species available, measurement standard error known. can also done () providing trait second collumn called [TRAIT]_se containing standard error measurements species.","code":"library(because) data(RhinoMulti.dat) data(rhino.tree)  RhinoMulti.eq <-list(     LS ~ BM,     NL ~ BM + RS,     DD ~ NL   )  RhinoMulti.bc <- because(   equations = RhinoMulti.eq,   data = RhinoMulti.dat,   structure = rhino.tree,   id_col = \"SP\", # species identifier column   variability = \"reps\", # specify that data contains repeated measures   parallel = TRUE,   n.cores = 3 )   summary(RhinoMulti.bc)  #                  Mean    SD Naive SE Time-series SE   2.5%    50% # alphaDD         0.593 0.291    0.005          0.008  0.043  0.588 # alphaLS         0.381 0.394    0.007          0.016 -0.384  0.384 # alphaNL        -0.084 0.321    0.006          0.012 -0.722 -0.085 # beta_DD_NL      0.539 0.079    0.001          0.001  0.383  0.539 # beta_LS_BM      0.446 0.084    0.002          0.002  0.287  0.445 # beta_NL_BM      0.466 0.068    0.001          0.001  0.333  0.465 # beta_NL_RS      0.592 0.069    0.001          0.001  0.463  0.592 # lambdaDD        0.484 0.134    0.002          0.003  0.221  0.485 # lambdaLS        0.698 0.106    0.002          0.003  0.453  0.708 # lambdaNL        0.696 0.091    0.002          0.002  0.503  0.705 # sigma_DD_phylo  0.826 0.178    0.003          0.004  0.516  0.813 # sigma_DD_res    0.842 0.094    0.002          0.002  0.668  0.839 # sigma_LS_phylo  1.249 0.206    0.004          0.005  0.869  1.234 # sigma_LS_res    0.796 0.105    0.002          0.002  0.607  0.790 # sigma_NL_phylo  0.997 0.146    0.003          0.004  0.739  0.986 # sigma_NL_res    0.644 0.079    0.001          0.002  0.501  0.641 #.                97.5%  Rhat n.eff # alphaDD        1.171 1.000  1295 # alphaLS        1.140 1.000   655 # alphaNL        0.545 1.001   744 # beta_DD_NL     0.693 1.000  2902 # beta_LS_BM     0.609 1.000  2205 # beta_NL_BM     0.602 1.001  2320 # beta_NL_RS     0.729 1.001  2916 # lambdaDD       0.735 1.000  1970 # lambdaLS       0.872 1.000  1448 # lambdaNL       0.853 1.000  1653 # sigma_DD_phylo 1.210 1.000  2057 # sigma_DD_res   1.039 1.000  2370 # sigma_LS_phylo 1.682 1.000  1445 # sigma_LS_res   1.021 1.000  1907 # sigma_NL_phylo 1.307 1.001  1503 # sigma_NL_res   0.816 1.000  2363 library(because) data(RhinoMulti_se.dat) data(rhino.tree)  RhinoMulti_se.bc <- because(   equations = RhinoMulti.eq,   data = RhinoMulti_se.dat,   structure = rhino.tree,   id_col = \"SP\",   variability = \"se\", # specify that data contains standard errors   parallel = TRUE,   n.cores = 3 )  summary(RhinoMulti_se.bc)  #                  Mean    SD Naive SE Time-series SE   2.5%    50% 97.5%  Rhat # alphaDD         0.581 0.289    0.005          0.008  0.003  0.577 1.132 1.002 # alphaLS         0.372 0.412    0.008          0.016 -0.435  0.373 1.188 1.003 # alphaNL        -0.117 0.352    0.006          0.015 -0.821 -0.125 0.587 1.002 # beta_DD_NL      0.541 0.077    0.001          0.001  0.392  0.541 0.691 1.000 # beta_LS_BM      0.442 0.086    0.002          0.002  0.275  0.441 0.612 1.000 # beta_NL_BM      0.466 0.069    0.001          0.002  0.331  0.465 0.603 1.000 # beta_NL_RS      0.591 0.069    0.001          0.002  0.450  0.591 0.721 1.000 # lambdaDD        0.492 0.135    0.002          0.003  0.238  0.494 0.751 1.001 # lambdaLS        0.700 0.105    0.002          0.003  0.463  0.713 0.866 1.006 # lambdaNL        0.701 0.090    0.002          0.002  0.505  0.709 0.854 1.000 # sigma_DD_phylo  0.833 0.181    0.003          0.004  0.515  0.823 1.224 1.000 # sigma_DD_res    0.832 0.091    0.002          0.002  0.663  0.828 1.017 1.000 # sigma_LS_phylo  1.252 0.201    0.004          0.005  0.872  1.240 1.666 1.010 # sigma_LS_res    0.796 0.106    0.002          0.002  0.602  0.790 1.020 1.002 # sigma_NL_phylo  1.005 0.148    0.003          0.004  0.743  0.996 1.326 1.000 # sigma_NL_res    0.642 0.078    0.001          0.002  0.500  0.640 0.808 1.000 #                n.eff # alphaDD         1237 # alphaLS          647 # alphaNL          579 # beta_DD_NL      2969 # beta_LS_BM      1712 # beta_NL_BM      2036 # beta_NL_RS      2055 # lambdaDD        2086 # lambdaLS        1571 # lambdaNL        1454 # sigma_DD_phylo  2147 # sigma_DD_res    2561 # sigma_LS_phylo  1553 # sigma_LS_res    2205 # sigma_NL_phylo  1501 # sigma_NL_res    2184"},{"path":"https://because-pkg.github.io/because.phybase/articles/03_phylogenetic_models.html","id":"accounting-for-uncertainity-in-the-phylogenetic-tree","dir":"Articles","previous_headings":"","what":"Accounting for uncertainity in the phylogenetic tree","title":"Phylogenetic Models","text":"cases uncertainty phylogenetic relationships among species, allows users fit models across sample trees described von Hardenberg Gonzalez Voyer, 2025). becomes trivial: just need provide list phylogenetic trees (class multiPhylo) structure argument instead single tree; randomly sample one tree list MCMC iteration, effectively integrating phylogenetic uncertainty estimating model parameters.","code":""},{"path":"https://because-pkg.github.io/because.phybase/articles/03_phylogenetic_models.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Phylogenetic Models","text":"von Hardenberg, . Gonzalez-Voyer, . (2025). PhyBaSE: Bayesian approach Phylogenetic Structural Equation Models. Methods Ecology Evolution. https://doi.org/10.1111/2041-210X.70044 Vehtari, ., Gelman, ., & Gabry, J. (2017). Practical Bayesian model evaluation using leave-one-cross-validation WAIC. Statistics Computing, 27(5), 1413-1432.","code":""},{"path":"https://because-pkg.github.io/because.phybase/articles/04_missing_data.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Phylogenetic Missing Data Imputation","text":"First, letâ€™s load package standard rhino dataset.","code":"library(because.phybase) data(rhino.dat) data(rhino.tree)"},{"path":"https://because-pkg.github.io/because.phybase/articles/04_missing_data.html","id":"simulating-missing-data","dir":"Articles","previous_headings":"","what":"Simulating Missing Data","title":"Phylogenetic Missing Data Imputation","text":"artificially introduce missing values (NA) dataset demonstrate handles . â€™ll add missingness : * LS (Litter Size): response variable model. * BM (Body Mass): parent-variable.","code":"# Create a copy of the data rhino_na <- rhino.dat  # Introduce 10% missing values in Litter Size (Response) set.seed(123) na_indices_ls <- sample(seq_len(nrow(rhino_na)), size = 10) rhino_na$LS[na_indices_ls] <- NA  # Introduce 5% missing values in Body Mass (Predictor) na_indices_bm <- sample(seq_len(nrow(rhino_na)), size = 5) rhino_na$BM[na_indices_bm] <- NA  # Verify missingness sum(is.na(rhino_na$LS)) sum(is.na(rhino_na$BM))"},{"path":"https://because-pkg.github.io/because.phybase/articles/04_missing_data.html","id":"the-model","dir":"Articles","previous_headings":"","what":"The Model","title":"Phylogenetic Missing Data Imputation","text":"define structural equation model (sem8) previous vignette: * Body Mass (BM) affects Litter Size (LS) Nose Length (NL). * Range Size (RS) affects Nose Length (NL). * Nose Length (NL) affects Dispersal Distance (DD).","code":"sem8.eq <- list(   LS ~ BM,   NL ~ BM + RS,   DD ~ NL )"},{"path":"https://because-pkg.github.io/because.phybase/articles/04_missing_data.html","id":"running-the-model","dir":"Articles","previous_headings":"","what":"Running the Model","title":"Phylogenetic Missing Data Imputation","text":"run () missing data, automatically detects NA values adjusts JAGS model structure.","code":"sem8_na.bc <- because(   equations = sem8.eq,   data = rhino_na,   structure = rhino.tree )  summary(sem8_na.bc)  #                  Mean    SD Naive SE Time-series SE   2.5%    50% 97.5% # alphaBM         1.283 0.545    0.010          0.029  0.170  1.294 2.348 # alphaDD         0.574 0.280    0.005          0.007  0.030  0.566 1.133 # alphaLS         0.346 0.407    0.007          0.015 -0.496  0.362 1.113 # alphaNL        -0.014 0.330    0.006          0.013 -0.659 -0.007 0.655 # beta_DD_NL      0.538 0.076    0.001          0.001  0.394  0.539 0.687 # beta_LS_BM      0.478 0.092    0.002          0.002  0.296  0.479 0.656 # beta_NL_BM      0.457 0.070    0.001          0.002  0.316  0.458 0.595 # beta_NL_RS      0.601 0.067    0.001          0.001  0.468  0.602 0.732 # lambdaBM        0.809 0.088    0.002          0.003  0.592  0.827 0.931 # lambdaDD        0.455 0.130    0.002          0.003  0.213  0.453 0.705 # lambdaLS        0.656 0.116    0.002          0.003  0.409  0.668 0.848 # lambdaNL        0.722 0.089    0.002          0.002  0.525  0.731 0.868 # sigma_BM_phylo  1.750 0.260    0.005          0.008  1.244  1.745 2.255 # sigma_BM_res    0.812 0.135    0.002          0.004  0.581  0.799 1.099 # sigma_DD_phylo  0.793 0.171    0.003          0.004  0.497  0.781 1.158 # sigma_DD_res    0.858 0.088    0.002          0.002  0.690  0.854 1.033 # sigma_LS_phylo  1.188 0.208    0.004          0.005  0.811  1.175 1.614 # sigma_LS_res    0.837 0.113    0.002          0.002  0.629  0.829 1.067 # sigma_NL_phylo  1.037 0.150    0.003          0.004  0.772  1.029 1.366 # sigma_NL_res    0.628 0.079    0.001          0.002  0.488  0.622 0.798 #                 Rhat n.eff # alphaBM        1.004   356 # alphaDD        1.000  1437 # alphaLS        1.002   734 # alphaNL        1.000   623 # beta_DD_NL     1.000  2910 # beta_LS_BM     1.000  2366 # beta_NL_BM     1.000  2198 # beta_NL_RS     1.002  2819 # lambdaBM       1.000  1152 # lambdaDD       1.000  2211 # lambdaLS       1.000  1630 # lambdaNL       1.003  1421 # sigma_BM_phylo 1.000  1183 # sigma_BM_res   1.000  1493 # sigma_DD_phylo 1.000  2275 # sigma_DD_res   1.000  2853 # sigma_LS_phylo 1.000  1742 # sigma_LS_res   1.000  2156 # sigma_NL_phylo 1.002  1307 # sigma_NL_res   1.002  2183 # # DIC: # Mean deviance:  884.1 # penalty 189.7 # Penalized deviance: 1074"},{"path":"https://because-pkg.github.io/because.phybase/articles/04_missing_data.html","id":"what-happened-automatically","dir":"Articles","previous_headings":"Running the Model","what":"What happened automatically?","title":"Phylogenetic Missing Data Imputation","text":"notice two important messages run model: â€œDetected missing data predictor-variables: BMâ€ JAGS impute missing values â€œfixedâ€ covariate data node. solve , automatically adds intercept-equation missing predictor (e.g., BM ~ 1). converts BM stochastic node (response variable) JAGS can sample missing values MCMC. â€œUsing Latent Variable (GLMM) approachâ€¦â€ variables missing data, handles carefully preserve phylogenetic signal. Instead simple imputation, uses element-wise likelihood integrates phylogenetic error structure, ensuring relationships estimated using full phylogenetic information available.","code":""},{"path":"https://because-pkg.github.io/because.phybase/articles/04_missing_data.html","id":"inspecting-imputed-values","dir":"Articles","previous_headings":"","what":"Inspecting Imputed Values","title":"Phylogenetic Missing Data Imputation","text":"Since missing values now parameters model, can actually inspect estimated values (posterior distributions). , must run () argument monitor = \"\". ensures imputed stochastic nodes saved output. can use helper function extract_imputed() easily retrieve values: returns tidy data frame Mean, SD, Credible Intervals (Q2.5, Q97.5) missing data point, labeled Species ID. variable LS missing values. JAGS model, missing values LS treated latent variables. variable BM (missing predictor) converted response variable (BM ~ 1) also imputed.","code":"# Run strictly monitoring 'all' parameters to get imputed values sem8_na_monitored.bc <- because(   equations = sem8.eq,   data = rhino_na,   structure = rhino.tree,   monitor = \"all\" )  # Extract posterior summaries for imputed values imputed_values <- extract_imputed(sem8_na_monitored.bc)  # View the first few imputed values head(imputed_values)  #       Variable  ID RowIndex         Mean        SD       Q2.5        Q50 # Mean        LS s14       14 -0.004710686 0.9342152 -1.8430269 0.02246534 # Mean1       LS s25       25  1.678043988 1.0829263 -0.4576528 1.73566859 # Mean2       LS s31       31  0.561576970 1.1507743 -1.6971686 0.57087689 # Mean3       LS s42       42  1.162445522 1.2150872 -1.3452741 1.13780737 # Mean4       LS s43       43  2.781955491 1.0852266  0.7474752 2.79039031 # Mean5       LS s50       50  2.762965171 1.1253402  0.5564907 2.71909773 #          Q97.5 # Mean  1.740653 # Mean1 3.646009 # Mean2 2.760267 # Mean3 3.589646 # Mean4 4.957594 # Mean5 4.982451"},{"path":"https://because-pkg.github.io/because.phybase/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Achaz von Hardenberg. Author, maintainer. Alejandro Gonzalez-Voyer. Author.","code":""},{"path":"https://because-pkg.github.io/because.phybase/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"von Hardenberg , Gonzalez-Voyer (2025). .phybase: Phylogenetic Structural Equation Models (PhyBaSE) R. R package version 0.1.1, https://-pkg.github.io/.phybase/. von Hardenberg, ., & Gonzalez-Voyer, . (2025). PhyBaSE: Bayesian structural equation model approach causal inference phylogenetic comparative analyses. Methods Ecology Evolution, 16(6), 1136-1148. <doi:10.1111/2041-210X.70044>","code":"@Manual{,   title = {because.phybase: Phylogenetic Structural Equation Models (PhyBaSE) in R},   author = {Achaz {von Hardenberg} and Alejandro Gonzalez-Voyer},   year = {2025},   note = {R package version 0.1.1},   url = {https://because-pkg.github.io/because.phybase/}, } @Article{,   title = {PhyBaSE: A Bayesian structural equation model approach to causal inference in phylogenetic comparative analyses},   author = {Achaz {von Hardenberg} and Alejandro Gonzalez-Voyer},   journal = {Methods in Ecology and Evolution},   year = {2025},   volume = {16},   number = {6},   pages = {1136-1148},   doi = {10.1111/2041-210X.70044}, }"},{"path":[]},{"path":"https://because-pkg.github.io/because.phybase/index.html","id":"phylogenetic-bayesian-structural-equation-models-phybase-extension-for-because","dir":"","previous_headings":"","what":"Phylogenetic Bayesian Structural Equation Models (PhyBaSE) extension for â€˜becauseâ€™","title":"PhyBaSE extension for because","text":".phybase extends package support phylogenetic covariance structures. implements S3 methods phylo multiPhylo objects ape package, enabling Bayesian Structural Equation Models phylogeneticaly-structured residuals (PhyBaSE, von Hardenberg & Gonzalez-Voyer, 2025).","code":""},{"path":"https://because-pkg.github.io/because.phybase/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"PhyBaSE extension for because","text":"Phylogenetic Covariance: Incorporates phylogenetic relatedness models. Phylogenetic Uncertainty: Supports multiPhylo objects account uncertainty tree topology branch lengths. Measurement error: Accounting measurement error traits providing repeated measures well specifying known measurement error variances. Phylogenetic missing data imputation: informs imputation missing data using phylogenetic relationships. Seamless Integration: Designed work transparently via S3 method dispatch.","code":""},{"path":"https://because-pkg.github.io/because.phybase/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"PhyBaSE extension for because","text":"install .phybase, run: .phybase depends installed automatically dependency. information functions available main package tutorials fully use functionalities please refer documentation","code":"remotes::install_github(\"because-pkg/because.phybase\")"},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti.dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Rhinograd Simulated Repeated Measures Data â€” RhinoMulti.dat","title":"Rhinograd Simulated Repeated Measures Data â€” RhinoMulti.dat","text":"simulated dataset containing repeated measurements life-history traits 100 Rhinograd species. dataset \"long\" format, 10 observations per species, suitable testing measurement error models using variability = \"reps\".","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti.dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rhinograd Simulated Repeated Measures Data â€” RhinoMulti.dat","text":"","code":"RhinoMulti.dat"},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti.dat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Rhinograd Simulated Repeated Measures Data â€” RhinoMulti.dat","text":"data frame 1000 rows (10 replicates x 100 species) 6 columns: SP Character. Species names matching tip labels rhino.tree. species appears 10 times. BM Numeric. Body mass (repeated measurements) LS Numeric. Litter size (repeated measurements) NL Numeric. Nose length (repeated measurements) DD Numeric. Dispersal distance (repeated measurements) RS Numeric. Range size (repeated measurements)","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti.dat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Rhinograd Simulated Repeated Measures Data â€” RhinoMulti.dat","text":"Simulated based Gonzalez-Voyer & von Hardenberg (2014) data.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti.dat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rhinograd Simulated Repeated Measures Data â€” RhinoMulti.dat","text":"dataset simulated adding white noise original rhino.dat species values. represents scenario species 10 independent observations trait. allows using variability = \"reps\" option () explicitly model measurement error. underlying causal model rhino.dat.","code":""},{"path":[]},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti_se.dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Rhinograd Means and Standard Errors â€” RhinoMulti_se.dat","title":"Rhinograd Means and Standard Errors â€” RhinoMulti_se.dat","text":"simulated dataset containing mean standard error varying life-history traits 100 Rhinograd species. dataset \"wide\" format (one row per species), suitable measurement error models using variability = \"se\".","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti_se.dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rhinograd Means and Standard Errors â€” RhinoMulti_se.dat","text":"","code":"RhinoMulti_se.dat"},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti_se.dat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Rhinograd Means and Standard Errors â€” RhinoMulti_se.dat","text":"data frame 100 rows 11 columns: SP Character. Species names matching tip labels rhino.tree. BM Numeric. Mean Body mass BM_se Numeric. Standard error Body mass (SD / sqrt(N)) LS Numeric. Mean Litter size LS_se Numeric. Standard error Litter size NL Numeric. Mean Nose length NL_se Numeric. Standard error Nose length DD Numeric. Mean Dispersal distance DD_se Numeric. Standard error Dispersal distance RS Numeric. Mean Range size RS_se Numeric. Standard error Range size","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti_se.dat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Rhinograd Means and Standard Errors â€” RhinoMulti_se.dat","text":"Calculated RhinoMulti.dat.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/RhinoMulti_se.dat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rhinograd Means and Standard Errors â€” RhinoMulti_se.dat","text":"dataset derived RhinoMulti.dat calculating mean standard error trait per species (N=10 replicates). designed use variability = \"se\" option (), precision modeled 1/SE^2.","code":""},{"path":[]},{"path":"https://because-pkg.github.io/because.phybase/reference/jags_structure_definition.multiPhylo.html","id":null,"dir":"Reference","previous_headings":"","what":"JAGS Structure Definition for Multiple Trees (Phylogenetic Uncertainty) â€” jags_structure_definition.multiPhylo","title":"JAGS Structure Definition for Multiple Trees (Phylogenetic Uncertainty) â€” jags_structure_definition.multiPhylo","text":"Implements jags_structure_definition S3 method multiPhylo objects.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/jags_structure_definition.multiPhylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"JAGS Structure Definition for Multiple Trees (Phylogenetic Uncertainty) â€” jags_structure_definition.multiPhylo","text":"","code":"# S3 method for class 'multiPhylo' jags_structure_definition(   structure,   variable_name = \"err\",   optimize = TRUE,   precision_parameter = \"lambda\",   ... )"},{"path":"https://because-pkg.github.io/because.phybase/reference/jags_structure_definition.multiPhylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"JAGS Structure Definition for Multiple Trees (Phylogenetic Uncertainty) â€” jags_structure_definition.multiPhylo","text":"structure multiPhylo object ape package. variable_name Name error variable (default \"err\"). optimize Logical. TRUE (default), uses pre-calculated precision matrices. precision_parameter Name precision parameter (default \"lambda\"). ... Additional arguments (ignored).","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/jags_structure_definition.multiPhylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"JAGS Structure Definition for Multiple Trees (Phylogenetic Uncertainty) â€” jags_structure_definition.multiPhylo","text":"list setup_code error_prior JAGS code strings.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/jags_structure_definition.phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"JAGS Structure Definition for Phylogenetic Trees â€” jags_structure_definition.phylo","title":"JAGS Structure Definition for Phylogenetic Trees â€” jags_structure_definition.phylo","text":"Implements jags_structure_definition S3 method phylo objects. method provided .phybase package extend base engine phylogenetic covariance support.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/jags_structure_definition.phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"JAGS Structure Definition for Phylogenetic Trees â€” jags_structure_definition.phylo","text":"","code":"# S3 method for class 'phylo' jags_structure_definition(   structure,   variable_name = \"err\",   optimize = TRUE,   precision_parameter = \"lambda\",   ... )"},{"path":"https://because-pkg.github.io/because.phybase/reference/jags_structure_definition.phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"JAGS Structure Definition for Phylogenetic Trees â€” jags_structure_definition.phylo","text":"structure phylo object ape package. variable_name Name error variable (default \"err\"). optimize Logical. TRUE (default), uses pre-calculated precision matrix. precision_parameter Name precision parameter (default \"lambda\"). ... Additional arguments (ignored).","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/jags_structure_definition.phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"JAGS Structure Definition for Phylogenetic Trees â€” jags_structure_definition.phylo","text":"list setup_code error_prior JAGS code strings.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/prepare_structure_data.multiPhylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Structure Data for Multiple Trees â€” prepare_structure_data.multiPhylo","title":"Prepare Structure Data for Multiple Trees â€” prepare_structure_data.multiPhylo","text":"Implements prepare_structure_data S3 method multiPhylo objects.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/prepare_structure_data.multiPhylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Structure Data for Multiple Trees â€” prepare_structure_data.multiPhylo","text":"","code":"# S3 method for class 'multiPhylo' prepare_structure_data(structure, data, optimize = TRUE, quiet = FALSE, ...)"},{"path":"https://because-pkg.github.io/because.phybase/reference/prepare_structure_data.multiPhylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Structure Data for Multiple Trees â€” prepare_structure_data.multiPhylo","text":"structure multiPhylo object ape package. data model data frame. optimize Logical. TRUE (default), returns precision matrices. quiet Logical. TRUE, suppresses messages. ... Additional arguments (ignored).","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/prepare_structure_data.multiPhylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Structure Data for Multiple Trees â€” prepare_structure_data.multiPhylo","text":"list structure_object (standardized trees) data_list (JAGS data).","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/prepare_structure_data.phylo.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Structure Data for Phylogenetic Trees â€” prepare_structure_data.phylo","title":"Prepare Structure Data for Phylogenetic Trees â€” prepare_structure_data.phylo","text":"Implements prepare_structure_data S3 method phylo objects.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/prepare_structure_data.phylo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Structure Data for Phylogenetic Trees â€” prepare_structure_data.phylo","text":"","code":"# S3 method for class 'phylo' prepare_structure_data(structure, data, optimize = TRUE, quiet = FALSE, ...)"},{"path":"https://because-pkg.github.io/because.phybase/reference/prepare_structure_data.phylo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Structure Data for Phylogenetic Trees â€” prepare_structure_data.phylo","text":"structure phylo object ape package. data model data frame. optimize Logical. TRUE (default), returns precision matrix. quiet Logical. TRUE, suppresses messages. ... Additional arguments (ignored).","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/prepare_structure_data.phylo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Structure Data for Phylogenetic Trees â€” prepare_structure_data.phylo","text":"list structure_object (standardized tree) data_list (JAGS data).","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Rhinograd life-history data â€” rhino.dat","title":"Rhinograd life-history data â€” rhino.dat","text":"dataset containing simulated life-history trait data 100 Rhinograd species. data used demonstrate phylogenetic Bayesian structural equation modeling becauseR package.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rhinograd life-history data â€” rhino.dat","text":"","code":"rhino.dat"},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.dat.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Rhinograd life-history data â€” rhino.dat","text":"data frame 100 rows (one per species) 6 columns: SP Character. Species names matching tip labels rhino.tree BM Numeric. Body mass (standardised) LS Numeric. Litter size (standardised) NL Numeric. Nose length (standardised) DD Numeric. Dispersal distance (standardised) RS Numeric. Range size (standardised)","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.dat.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Rhinograd life-history data â€” rhino.dat","text":"Simulated data Gonzalez-Voyer & von Hardenberg (2014)","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.dat.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rhinograd life-history data â€” rhino.dat","text":"simulated dataset represents life-history traits hypothetical Rhinograd species. data can used test causal hypotheses life-history evolution using phylogenetic structural equation models. Example causal model (Model 8 Gonzalez-Voyer von Hardenberg (2014)): Body mass (BM) affects litter size (LS) Body mass (BM) range size (RS) affect nose length (NL) Nose length (NL) affects dispersal distance (DD)","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.dat.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rhinograd life-history data â€” rhino.dat","text":"Gonzalez-Voyer, ., & von Hardenberg, . (2014). introduction phylogenetic path analysis. : Modern phylogenetic comparative methods application evolutionary biology (pp. 201â€“229). Springer.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.dat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rhinograd life-history data â€” rhino.dat","text":"","code":"data(rhino.dat) head(rhino.dat) #>   SP         BM        NL          LS         DD         RS #> 1 s1 -0.7669046 -2.017574 -0.09476713 -0.7922619 -3.3926965 #> 2 s2 -1.0097044 -1.742466 -2.14633494  1.7643208 -1.0467189 #> 3 s3 -1.2252812 -2.468553 -0.63206843 -1.8061550 -2.8596606 #> 4 s4  1.3305352  0.340559 -0.13426489  0.9488741 -0.2786894 #> 5 s5  2.4923437  1.224005  0.60823620  1.6241513  0.2208142 #> 6 s6  1.4251486  2.969227  3.08553399  2.2524221  2.4268047 summary(rhino.dat) #>       SP                  BM                NL                 LS           #>  Length:100         Min.   :-2.3373   Min.   :-2.66773   Min.   :-2.14633   #>  Class :character   1st Qu.: 0.4526   1st Qu.: 0.01542   1st Qu.:-0.09736   #>  Mode  :character   Median : 1.5854   Median : 1.10201   Median : 1.20535   #>                     Mean   : 1.6824   Mean   : 1.05258   Mean   : 1.23445   #>                     3rd Qu.: 2.7206   3rd Qu.: 2.14295   3rd Qu.: 2.26928   #>                     Max.   : 5.4368   Max.   : 5.02897   Max.   : 5.69822   #>        DD                RS            #>  Min.   :-2.9747   Min.   :-3.392697   #>  1st Qu.: 0.1442   1st Qu.:-0.001407   #>  Median : 1.0129   Median : 0.879031   #>  Mean   : 1.0841   Mean   : 0.965484   #>  3rd Qu.: 2.1425   3rd Qu.: 2.057613   #>  Max.   : 4.4773   Max.   : 4.942733"},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Rhinograd phylogenetic tree â€” rhino.tree","title":"Rhinograd phylogenetic tree â€” rhino.tree","text":"phylogenetic tree (phylo object) 100 simulated Rhinograd species. tree used demonstrate phylogenetic Bayesian structural equation modeling becauseR package.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.tree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rhinograd phylogenetic tree â€” rhino.tree","text":"","code":"rhino.tree"},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.tree.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Rhinograd phylogenetic tree â€” rhino.tree","text":"phylo object (ape package) 100 tips 99 internal nodes. tree scaled root age 1.0.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.tree.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Rhinograd phylogenetic tree â€” rhino.tree","text":"Simulated data Gonzalez-Voyer von Hardenberg (2014)","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.tree.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Rhinograd phylogenetic tree â€” rhino.tree","text":"Rhinograds  hypothetical mammals used examples phylogenetic comparative methods. simulated tree represents evolutionary relationships among 100 Rhinograd species.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.tree.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rhinograd phylogenetic tree â€” rhino.tree","text":"Gonzalez-Voyer, ., & von Hardenberg, . (2014). introduction phylogenetic path analysis. : Modern phylogenetic comparative methods application evolutionary biology (pp. 201â€“229). Springer.","code":""},{"path":"https://because-pkg.github.io/because.phybase/reference/rhino.tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rhinograd phylogenetic tree â€” rhino.tree","text":"","code":"data(rhino.tree) plot(rhino.tree)"}]
